
# Sphinx Learnings

The documentation uses Sphinx.  I'm putting learnings on how to do non intuitive Sphinx things here.

## Autobuild
Autobuild brings WYSIWYG editing.  It is extremely useful when editing Sphinx docs!

I tried using the [RST page preview](https://marketplace.visualstudio.com/items?itemName=lextudio.restructuredtext) which was great until I switched to markdown.  With [Autobuild](https://github.com/executablebooks/sphinx-autobuild), I have a WYSIWYG environment which makes editing much more of a delight.  The Autobuild documentation is good enough to get going.  Here is the command to start autobuild going:
```console
 sphinx-autobuild docs docs/_build/html
```

The command assumes the md or rst files are in the docs directory and the output is in docs/_build/html.

## sphinx-apidoc
[sphinx-apidoc](https://www.sphinx-doc.org/en/master/man/sphinx-apidoc.html) is a command line utility that will pull out the documentation from the Python code.  It will grab all the files from the directory holding the code files.  To generate the code,
1. From a command line change to the code directory.
2. Type in and execute the command:
```console
 $ sphinx-apidoc -f -o . ..\code
```
The command creates .rst files in the docs folder (that's why we start there) for each code file it finds in the \code directory.  It also creates the modules.rst and code.rst files.
This will create a [modules.rst file](modules.rst), as well as .rst files for the other GrowBuddy modules.


## Myst-parser

[Myst-parser](https://myst-parser.readthedocs.io/en/latest/) defines a version of markdown that understands Sphinx's roles and directives.  I find markdown much simpler than restructured text.  The challenge I have is I can't quite get off restructured text format because the code documentation generated by `sphinx-apidoc` requires rst syntax to resolve some things (I found this to be true for links).

See [Geting Started with Myst](https://myst-parser.readthedocs.io/en/latest/intro.html)

### Extensions
Directives such as:
```
:::{figure} images/SnifferBuddy_wiring.jpg
:align: center
:scale: 100

SnifferBuddy Wiring
:::
```
require extensions to markdown that the Myst parser will optionally handle if the extension is listed in `myst_enable_extensions` in `conf.py`.  To handle images and figures, add the following to conf.py:
```
myst_enable_extensions = ["colon_fence"]
```
Now we can include restructured text images/figures directives.

:::{figure} images/SnifferBuddy_wiring.jpg
:align: center
:scale: 100

SnifferBuddy Wiring
:::

### Example
In this example, we start with a file in rst format and convert to markdown.  To do this, we use the rst-to-myst[sphinx]
1. Install the library into your virtual environment `pip install rst-to-myst[sphinx]`
2. Convert the files.  I put snifferbuddy.rst into the rst-test-files folder to give us an example to work with. 
```
rst2myst convert ../rst-test-files/* .
```
## Cross-Linking Between Sphinx Docs

Where the link is use \{ref\}\`Custom title \<anchor name\>\`.  Before the m(H1, H2...) Heading, use `(anchor name)=` .

For example, {ref}`Let's make a SnifferBuddy <make-snifferbuddy>` is a cross reference link to the section in SnifferBuddy with the steps to make a SnifferBuddy.



